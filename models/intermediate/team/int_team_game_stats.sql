select
    gs.game_id,
    gs.game_date,
    gs.season_id,
    gs.season_type,
    gd.attendance, -- game attendance
    gs.team_id_home,
    gs.team_id_away,
    th.nickname as team_name_home,
    ta.nickname as team_name_away,
    th.city as city_home,
    ta.city as city_away,
    gs.wl_home,
    gs.game_minutes,
    gs.fgm_home,
    gs.fga_home,
    gs.fgm_away,
    gs.fga_away,
    gs.fg3m_home,
    gs.fg3a_home,
    gs.fg3m_away,
    gs.fg3a_away,
    gs.ftm_home,
    gs.fta_home,
    gs.ftm_away,
    gs.fta_away,
    gs.oreb_home,
    gs.oreb_away,
    gs.dreb_home,
    gs.dreb_away,
    gs.ast_home,
    gs.ast_away,
    gs.stl_home,
    gs.stl_away,
    gs.blk_home,
    gs.blk_away,
    gs.tov_home,
    gs.tov_away,
    gs.pf_home,
    gs.pf_away,
    gs.pts_home,
    gs.pts_away,
    gs.plus_minus_home,
    gs.plus_minus_away
from {{ ref('stg_game_stats')}} gs
left join {{ ref('stg_game_attendance')}} gd on gs.game_id = gd.game_id
left join {{ ref('stg_team_details')}} th on gs.team_id_home = th.team_id
left join {{ ref('stg_team_details')}} ta on gs.team_id_away = ta.team_id
where gs.game_date > '2019-10-01' -- take only games from 2019-2020 season
